//==============================================================================
// main.h
// main engine
//
// Created by Hugo Pristauz on 2022-Jun-01
// Copyright Â© 2022 fuseAware. All rights reserved.
//==============================================================================
//
// Bluccino work bench model:
// - high level modules to be controlled by MAIN are FA_APP (app stuff)
//   and FT_TEST (test stuff to test app) are on top of the work bench.
// - low level modules to be controlled by MAIN are BLUCCINO, FC_WLCORE
//   (wireless core module) and HW_CORE (hard ware core module), both
//   communicating with the (Zephyr) RTOS.
//
//     +------------+    TOCK     +------------+    TOCK     +------------+
//     |    main    |    TICK     |    app     |    TICK     |    test    |
//     +------------+    INIT     +------------+    INIT     +------------+
//     |    SYS:    |============>|    SYS:    |============>|    SYS:    |
//     +------------+             +------------+             +------------+
//     |    ....    |             |    ....    |             |    ....    |
//     +-----o^-----+             +-----o^-----+             +-----o^-----+
//           ||                         ||                         ||
//    =======vo=========================vo=========================vo=======
//    |                                TOP                                 |
//    ====o============================================================^====
//     |  |  |                                                      |  |  |
//     +--v--+                     core system                      +--o--+
//      |   |                  +------------------+                  |   |
//      | D |----------------->|       bl_hw      |----------------->|   |
//      | O |                  +------------------+                  | U |
//      | W |----------------->|       bl_fw      |----------------->| P |
//      | N |                  +-----o------^-----+                  |   |
//      |   |                        |      |                        |   |
//      |   |========================|======|========================|   |
//      |   |  +---------------------v------o---------------------+  |   |
//      |   |  |                   ZEPHYR RTOS                    |  |   |
//      =====  +--------------------------------------------------+  =====
//
//==============================================================================
//
// Typical hierarchy and output message flow with test module integration,
// demonstrating that
//
// +- MAIN => bl_run(app,tick_ms,tock_ms,when)
//     |
//     |    |<=============================|
//          |                              |
//     +- app ============================>|    (application)
//     |                                   |
//.....|...................................|....................................
//     |                                   |
//     +- bluccino =======================>|    (Bluccino module)
//          |                              |
//          +- bl_top ====================>|    (top gear)
//          |    |
//          |    |<========|
//          |              |
//          +- bl_up =====>|                    (upward gear)
//          |    |
//          |    |<========================|
//          |                              |
//          +- bl_down                     |    (downward gear)
//               |                         |
//               +- bl_hw ================>|    (hardware core system)
//               |    |  |                 |
//               |    |  |<============|   |
//               |    |                |   |
//               |    +- bl_hwled ====>|   |    (core LED driver)
//               |    +- bl_hwbut ====>|   |    (core button driver)
//               |    +- bl_hwnvm ====>|   |    (core NVM driver)
//               |                         |
//               +- bl_wl ================>|    (wireless core system)
//
//==============================================================================
//
// global initializing scheme:
//
//   main       bluccino          gear         app         bl_wl        bl_hw
// bl_engine      (B)          (D)(U)(T)       (A)          (W)          (H)
//    |            |            |  |  |         |            |            |
//    | [SYS:INIT] |            |  |  |         |            |            |
//    o----------->|===========================>|            |            |
//    |   <app>    |            |  |  |         |            |            |
//    |            | [SYS:INIT] |  |  |         |            |            |
//    |            o-------------->|=>|         |            |            |
//    |            |  <bl_top>  |  |  |         |            |            |
//    |            |            |  |  |         |            |            |
//    |            | [SYS:INIT] |  |  |         |            |            |
//    |            o----------------->|========>|            |            |
//    |            |    <app>   |  |  |         |            |            |
//    |            |            |  |  |         |            |            |
//    |            | [SYS:INIT] |  |  |         |            |            |
//    |            o----------->|=>|  |         |            |            |
//    |            |  <bl_up>   |  |  |         |            |            |
//    |            |            |  |  |         | [SYS:INIT] |            |
//    |            |            o--------------------------->|            |
//    |            |            |  |  |         |  <bl_up>   |            |
//    |            |            |  |<========================|            |
//    |            |            |  |  |         |            |            |
//    |            |            |  |  |         | [SYS:INIT] |            |
//    |            |            o---------------------------------------->|
//    |            |            |  |  |         |  <bl_up>   |            |
//    |            |            |  |<=====================================|
//    |            |            |  |  |         |            |            |
//    |            |            |  |  |         |            |            |
//    |            | [SYS:INIT] |  |  |         |            |            |
//    o---------------------------------------->|            |            |
//    |            |    <app>   |  |  |         |            |            |
//    |            |            |  |  |         |            |            |
//
//==============================================================================
